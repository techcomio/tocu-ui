// contra@v1.8.1, MIT licensed. https://github.com/bevacqua/contra
!function(n,t,r){"use strict";function e(){}function u(t){return"[object Array]"===n.prototype.toString.call(t)}function i(n,t){return Array.prototype.slice.call(n,t)}function o(n,t,r){n&&y(function(){n.apply(r||null,t||[])})}function f(n){function t(){r||(r=!0,(n||e).apply(null,arguments))}var r;return t.discard=function(){r=!0},t}function c(n,t,r){var e=n.shift();return e?(r&&r.discard(),o(t,[e]),!0):void 0}function a(){var n=i(arguments),t=n.shift();return function(){var r=i(arguments);t.apply(t,n.concat(r))}}function s(n,t){function r(){var t=i(arguments),u=n.shift();if(u){if(c(t,e))return;t.push(f(r)),o(u,t)}else o(e,arguments)}var e=f(t);r()}function l(t,r,e){function a(n,r){function e(){var t=i(arguments);c(t,s)||(h[n]=t.shift(),r())}o(t[n],[e])}"function"==typeof r&&(e=r,r=x);var s=f(e),l=g(a,r),p=n.keys(t),h=u(t)?[]:{};l.unshift(p),l.on("drain",function(){s(null,h)})}function p(n,t){l(n,k,t)}function h(t,r,e){var i=function(e,i,o,c){var a=arguments;2===a.length&&(o=i,i=x),3===a.length&&"number"!=typeof i&&(c=o,o=i,i=x);var s=n.keys(e),p=u(e)?[]:{};s.forEach(function(n){p[n]=function(t){3===o.length?o(e[n],n,t):o(e[n],t)}}),l(p,t||i,r?r(e,f(c)):c)};return e||(i.series=h(k,r,!0)),i}function m(n){function t(n,t){return function(n){t(n)}}return h(n,t)}function v(t){function r(t,r){return function(e,i){function o(n,t){return!!i[t]}function f(){var r={};return n.keys(t).forEach(function(n){o(null,n)&&(r[n]=t[n])}),r}return e?void r(e):void r(null,u(i)?t.filter(o):f())}}return h(t,r)}function d(n,t){var e=t||{},u={};return n===r&&(n={}),n.on=function(t,r){return u[t]?u[t].push(r):u[t]=[r],n},n.once=function(t,r){return r._once=!0,n.on(t,r),n},n.off=function(t,r){var e=arguments.length;if(1===e)delete u[t];else if(0===e)u={};else{var i=u[t];if(!i)return n;i.splice(i.indexOf(r),1)}return n},n.emit=function(){var t=i(arguments);return n.emitterSnapshot(t.shift()).apply(this,t)},n.emitterSnapshot=function(t){var r=(u[t]||[]).slice(0);return function(){var u=i(arguments),f=this||n;if("error"===t&&e.throws!==!1&&!r.length)throw 1===u.length?u[0]:u;return r.forEach(function(r){e.async?o(r,u,f):r.apply(f,u),r._once&&n.off(t,r)}),n}},n}function g(t,r){function e(n,t,r){var e=u(t)?t:[t];e.forEach(function(t){l[n]({t:t,done:r})}),o(c)}function c(){if(!(s||p>=h)){if(!l.length)return void(0===p&&m.emit("drain"));p++;var n=l.pop();t(n.t,f(a.bind(null,n))),o(c)}}function a(n){p--,o(n.done,i(arguments,1)),o(c)}var s,l=[],p=0,h=r||1,m=d({push:e.bind(null,"push"),unshift:e.bind(null,"unshift"),pause:function(){s=!0},resume:function(){s=!1,o(c)},pending:l});return n.defineProperty&&!n.definePropertyPartial&&n.defineProperty(m,"length",{get:function(){return l.length}}),m}var y,b=""+r,k=1,x=1/0,E="function"==typeof setImmediate;y=E?function(n){setImmediate(n)}:typeof process!==b&&process.nextTick?process.nextTick:function(n){setTimeout(n,0)};var P={curry:a,concurrent:l,series:p,waterfall:s,each:m(),map:h(),filter:v(),queue:g,emitter:d};typeof module!==b&&module.exports?module.exports=P:t.contra=P}(Object,this);